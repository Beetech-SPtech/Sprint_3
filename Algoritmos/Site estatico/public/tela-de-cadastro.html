<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cadastro</title>
    <link rel="stylesheet" href="styles/cadastro.css">
    <link rel="icon" href="assets/images/beetech-icon.png">
</head>

<body>
    <div class="ajuda"><a href="">Precisa de ajuda?</a><i class="fas fa-headset"></i></div>
    <div class="container-pai">
        <header>
            <div class="container">
                <a href="index.html"><img src="assets/images/beetech.png" alt="logo_beetech" /></a>
                <ul class="navbar">
                    <li><a href="index.html">Voltar para a p√°gina inicial</a></li>

                </ul>
            </div>
        </header>
        <div class="main">
            <div class="container">
                <img src="assets/images/beetech-logo.png" alt="" class="fundo">
                <br>
                <br>
                <h3>CADASTRO</h3>
                <br>
                <div class="container-campos">
                    <div class="campos">
                        <div class="ladoEsquerdo">
                            <div class="caixaInput">
                                <p class="cabecalho">Nome:</p>
                                <input type="text" placeholder="Ex: Bee" id="input_nome" oninput="cadastrar()" />
                                <p id="erro_nome"></p>
                            </div>
                            <div class="caixaInput">
                                <p class="cabecalho">E-mail:</p>
                                <input type="text" placeholder="Ex: beetech@sptech.school" id="input_email"
                                    oninput="cadastrarEmail()" />
                                <p id="erro_email"></p>
                            </div>
                            <!-- <div class="caixaInput">
                        <p class="cabecalho">Data de nascimento:</p>
                        <input type="text" placeholder="Ex: 21/01/2007" id="input_nascimento" oninput="cadastrarNascimento()" />
                        <p id="erro_nascimento"></p>
                    </div> -->
                            <div class="caixaInput">
                                <p class="cabecalho">Confirmar senha:</p>
                                <input type="password" placeholder="Ex: Beetech#2025" id="input_confirmarsenha"
                                    oninput="cadastrar()" />
                                <p id="erro_confirmarsenha"></p>
                            </div>
                        </div>
                        <div class="ladoDireito">
                            <div class="caixaInput">
                                <p class="cabecalho">CPF:</p>
                                <input type="number" placeholder="Ex: Tech" id="input_cpf" oninput="cadastrar()" />
                                <p id="erro_sobrenome"></p>
                            </div>


                            <!-- <div class="caixaInput">
                        <p class="cabecalho">Telefone:</p>
                        <input type="text" placeholder="Ex: 1191234123" id="input_telefone" oninput="cadastrarTelefone()" />
                        <p id="erro_telefone"></p>
                    </div> -->

                            <div class="caixaInput">
                                <p class="cabecalho">Senha:</p>
                                <input type="password" placeholder="Ex: Beetech#2025" id="input_senha"
                                    oninput="cadastrar()" />
                                <p id="erro_senha1"></p>
                                <p id="erro_senha2"></p>
                                <p id="erro_senha3"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="div_button">
                    <br>
                    <button id="button_cadastrar" onclick="cadastrar()">Cadastrar</button>
                    <p id="erro_confirmarcadastro"></p>
                    <br>
                    <a href="login.html">Login </a>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>

</html>

<!-- // --------------------------------------------------- -->
<script>


    let listaUsuarioCadastrado = [];

    function cadastrar() {
        // aguardar();


        var nomeVar = input_nome.value;
        var sobrenomeVar = input_sobrenome.value;
        var emailVar = input_email.value;
        var senhaVar = input_senha.value;
        var cpfVar = input_cpf.value;
        var confirmarsenhaVar = input_confirmarsenha.value;

        if(senhaVar != confirmarsenhaVar ){
            cardErro.style.display = "block";
            mensagem_erro.innerHTML =
                "(Mensagem de erro para senhas diferentes)";
        }else {
            
        if (
            nomeVar == "" ||
            emailVar == "" ||
            senhaVar == "" ||
            cpfVar == ""
        ) {
            cardErro.style.display = "block";
            mensagem_erro.innerHTML =
                "(Mensagem de erro para todos os campos em branco)";
        }

        fetch("/usuario/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({


                nomeServer: nomeVar,
                sobrenomeServer: sobrenomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar

            }),
        })
            // colocar a minha div de erro
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    cardErro.style.display = "block";

                    mensagem_erro.innerHTML =
                        "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

                    setTimeout(() => {
                        window.location = "../public/login.html";
                    }, "2000");


                } else {
                    throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
                ;
            });

        return false;
    }
        }


</script>